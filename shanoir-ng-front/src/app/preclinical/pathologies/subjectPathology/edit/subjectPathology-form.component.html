
<div *ngIf="toggleForm" class="SubjectPathologyFormComponent content-component">
    <form [formGroup]="newSubjectPathologyForm" class="SubjectPathologyFormComponent max-content" novalidate>
		<table class="layout">
			<tr><td colspan="2">
				<span class="right-col" [ngSwitch]="mode.state">
					<ng-template [ngSwitchCase]="Modes.view">
						<div class="header command-zone" i18n="View pathology|Title">View pathology details</div>
					</ng-template>
					<ng-template ngSwitchDefault> 
						<div *ngIf="!createSPMode" class="header command-zone" i18n="Edit pathology|Title">Edit pathology</div>
						<div *ngIf="createSPMode"  class="header command-zone" i18n="Create pathology|Title">Add pathology</div>
					</ng-template>
				</span>
			</td></tr>
			<tr>
				<td>
					<fieldset>
					<ol>
					<!-- 
						<li class="required">
							<label i18n="Edit subject|Ngid label" class="required-label">id</label> 
							<input type="text" id="id" formControlName="id" [(ngModel)]="subjectPathology.id"/>
						</li>
						 -->
						<li class="required">
							<label i18n="Edit subPatho|Pathology label" class="required-label">Pathology</label>
							<span class="right-col" [ngSwitch]="mode.state">
								<ng-template [ngSwitchCase]="Modes.view"> 
										{{subjectPathology?.pathology?.name}}
								</ng-template>
								<ng-template ngSwitchDefault>
									<select id="pathology" required formControlName="pathology" [(ngModel)]="subjectPathology.pathology" (change)="refreshModelsByPathology()">
										<option *ngFor="let pathology of pathologies" [ngValue]="pathology">{{pathology.name}}</option>
									</select>
									<button *ngIf="keycloakService.isUserAdmin()" i18n="Edit subPatho|Add a new pathology" (click)="goToAddPathology()">
										<img [src]="addIconPath"/>
										new pathology
									</button>
									<label *ngIf="formErrors.pathology.includes('required')" class="form-validation-alert" i18n="Edit model|PathologyRequiredError label">Pathology is required!</label>
								</ng-template>
							</span>
						</li>
						<li class="required">
							<label i18n="Edit subPatho|PathologyModel label" class="required-label">Model</label> 
							<span class="right-col" [ngSwitch]="mode.state">
								<ng-template [ngSwitchCase]="Modes.view"> 
										{{subjectPathology?.pathologyModel?.name}}
								</ng-template>
								<ng-template ngSwitchDefault>
									<select id="pathologyModel" required formControlName="pathologyModel" [(ngModel)]="subjectPathology.pathologyModel">
										<option *ngFor="let model of modelsDisplay" [ngValue]="model">{{model.name}}</option>
									</select>
									<button *ngIf="keycloakService.isUserAdmin()" i18n="Edit subPatho|Add a new pathology model" (click)="goToAddPathologyModel()">
										<img [src]="addIconPath"/>
										new model
									</button>
									<label *ngIf="formErrors.pathologyModel.includes('required')" class="form-validation-alert" i18n="Edit model|PathologyRequiredError label">Pathology model is required!</label>
								</ng-template>
							</span>
						</li>
						<li class="required">
							<label i18n="Edit subPatho|Location label" class="required-label">Location</label>
							<span class="right-col" [ngSwitch]="mode.state">
								<ng-template [ngSwitchCase]="Modes.view"> 
										{{subjectPathology?.location?.value}}
								</ng-template>
								<ng-template ngSwitchDefault>
									<select id="location" required formControlName="location" [(ngModel)]="subjectPathology.location">
										<option *ngFor="let location1 of locations" [ngValue]="location1">{{location1.value}}</option>
									</select>
									<button *ngIf="keycloakService.isUserAdmin()" i18n="Edit subPatho|Add a new location" (click)="goToAddLocation()">
										<img [src]="addIconPath"/>
										new location
									</button>
								<label *ngIf="formErrors.location.includes('required')" class="form-validation-alert" i18n="Edit model|LocationRequiredError label">Location is required!</label>
								</ng-template>
							</span>
						</li>
						<li>
							<label i18n="Edit subjectTherapy|startDate label">Start date</label>
							<span class="right-col" [ngSwitch]="mode.state">
								<ng-template [ngSwitchCase]="Modes.view"> 
										{{subjectPathology?.startDate}}
								</ng-template>
								<ng-template ngSwitchDefault>
									<my-date-picker id="startDate" [options]="myDatePickerOptions" formControlName="startDate" [(ngModel)]="subjectPathology.startDate" 
										(dateChanged)="onDateChanged($event,'start')" (inputFieldChanged)="onInputFieldChanged($event,'start')" [selDate]="selectedStartDate">
									</my-date-picker>
									<label *ngIf="isDateValid==false" class="form-validation-alert" i18n="Edit user|DateValidError label">Date should be valid! Date format: yyyy-mm-dd</label>
								</ng-template>
							</span>
						</li>
						<li>
							<label i18n="Edit subjectTherapy|endDate label">End date</label>
							<span class="right-col" [ngSwitch]="mode.state">
								<ng-template [ngSwitchCase]="Modes.view"> 
										{{subjectPathology?.startDate}}
								</ng-template>
								<ng-template ngSwitchDefault>
									<my-date-picker id="endDate" [options]="myDatePickerOptions" formControlName="endDate" [(ngModel)]="subjectPathology.endDate" 
										(dateChanged)="onDateChanged($event,'end')" (inputFieldChanged)="onInputFieldChanged($event,'end')" [selDate]="selectedEndDate">
									</my-date-picker>
									<label *ngIf="isDateValid==false" class="form-validation-alert" i18n="Edit user|DateValidError label">Date should be valid! Date format: yyyy-mm-dd</label>
								</ng-template>
							</span>
						</li>
					</ol>
					</fieldset>
				</td>				
			</tr>
			
			<tr><td colspan="2"><div class="footer command-zone">
				<button type="button" i18n="Edit pathology|CancelButton label" class="Button" (click)="toggleFormSPAndReset()">Close</button>
				<button type="button" *ngIf="createSPMode  && canModify && !mode.isViewMode()" i18n="Edit pathology|CreateButton label" (click)="addSubjectPathology()" class="Button" [disabled]="!newSubjectPathologyForm.valid">Add</button>
				<button type="button" *ngIf="!createSPMode && canModify && !mode.isViewMode()" (click)="updateSubjectPathology()" i18n="Edit pathology|SaveButton label" class="Button" [disabled]="!newSubjectPathologyForm.valid">Save</button>
			</div></td></tr>
		</table>
    </form>
</div>