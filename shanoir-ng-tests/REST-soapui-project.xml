<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="4b67039d-2b8b-4d17-9a8f-ed5c3a888e69" activeEnvironment="Default" name="REST Shanoir-NG" soapui-version="5.2.1" abortOnError="false" runType="SEQUENTIAL" resourceRoot="" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="a6e8bb67-2307-4d8b-9654-14d21e054e99" wadlVersion="http://wadl.dev.java.net/2009/02" name="Shanoir NG Users Microservice" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:description>Microservice API for Shanoir NG user managment</con:description><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>${#Project#endpoint}</con:endpoint></con:endpoints><con:resource name="/role/all" path="/role/all" id="06c0c67a-00cb-42b7-848f-eecfd43c04c8"><con:settings/><con:parameters/><con:method name="findRoles" id="029ec817-e619-43d8-b693-67df0968cefa" method="GET"><con:description>Returns all the roles
</con:description><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>204</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status/><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>text/html</con:mediaType><con:status>200</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>204</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="7f113040-e394-4bce-a620-bf2a818be1ee" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="x-auth-token" value="${#TestCase#token_auth}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding/><con:endpoint>${#Project#endpoint}</con:endpoint><con:request/><con:originalUri>http://localhost/rest/role/all</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="/user" path="/user" id="4000119b-9e0f-461b-9103-59409fa8d112"><con:settings/><con:parameters/><con:method name="saveNewUser" id="700e3d8d-9363-497f-af83-9e64846c9c4d" method="POST"><con:description>Saves a new user
</con:description><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>422</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status/><con:params/></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>403 422</con:status><con:params/><con:element xmlns:user="http://localhost/user">user:Fault</con:element></con:representation><con:representation type="FAULT"><con:mediaType xsi:nil="true"/><con:status>401</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="e900207c-3be4-4ea9-a454-1b4012a07d82" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="x-auth-token" value="${#TestCase#token_auth}"/>
  &lt;con:entry key="x-xsrf-token" value="${#TestCase#token_xsrf}"/>
&lt;/xml-fragment></con:setting></con:settings><con:endpoint>${#Project#endpoint}</con:endpoint><con:request>{
	"username" : "test",
	"firstName" : "First name test",
	"lastName" : "Last name test",
	"email" : "testautofli@gmail.com",
	"creationDate" : "2016-11-28",
	"role" : {}
	
	
	}</con:request><con:originalUri>http://localhost/user</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="/user/all" path="/user/all" id="1adebb44-91d3-46ff-8279-3f357a2ea996"><con:settings/><con:parameters/><con:method name="findUsers" id="6b6b2b1b-cf12-4e56-a162-09985e9af05d" method="GET"><con:description>Returns all the users
</con:description><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>204</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status/><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>text/html</con:mediaType><con:status>200</con:status><con:params/><con:element>html</con:element></con:representation><con:request name="Request 1" id="cb15771f-5c75-4a50-9843-73a0ded906bc" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="x-auth-token" value="${#TestCase#token_auth}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding/><con:endpoint>${#Project#endpoint}</con:endpoint><con:request/><con:originalUri>http://localhost/login</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="/user/{userId}" path="/user/{userId}" id="703b7e16-4653-44cb-a0d6-524b533209be"><con:settings/><con:parameters/><con:method name="findUserById" id="1db64152-978d-41c1-98c9-c8409164d426" method="GET"><con:description>If exists, returns the user corresponding to the given id
</con:description><con:settings/><con:parameters><con:parameter required="true"><con:name>userId</con:name><con:style>TEMPLATE</con:style><con:description>id of the user</con:description></con:parameter></con:parameters><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>404</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status/><con:params/></con:representation><con:request name="Request 1" id="8d3913ac-2ce3-4a6f-892f-9ebbd5d2cb37" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="x-auth-token" value="${#TestCase#token_auth}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:encoding/><con:endpoint>${#Project#endpoint}</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method><con:method name="updateUser" id="0c245ddb-05f6-499a-8f40-7ac4c225f5da" method="PUT"><con:description>Updates a user
</con:description><con:settings/><con:parameters><con:parameter required="true"><con:name>userId</con:name><con:style>TEMPLATE</con:style><con:description>id of the user</con:description></con:parameter></con:parameters><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>204</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>422</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status/><con:params/></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:request name="Request 1" id="10b23131-3af2-4785-9400-5a8d813bd785" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="x-auth-token" value="${#TestCase#token_auth}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>${#Project#endpoint}</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method><con:method name="deleteUser" id="5e6aed9f-5e85-45f1-b4ec-570a8ec85326" method="DELETE"><con:description>Deletes a user
</con:description><con:settings/><con:parameters><con:parameter required="true"><con:name>userId</con:name><con:style>TEMPLATE</con:style><con:description>id of the user</con:description></con:parameter></con:parameters><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>204</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>404</con:status><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status/><con:params/></con:representation><con:request name="Request 1" id="904c0c10-4f1b-41f2-b2ea-497ddabfd3db" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;entry key="x-auth-token" value="${#TestCase#token_auth}" xmlns="http://eviware.com/soapui/config"/></con:setting></con:settings><con:endpoint>${#Project#endpoint}</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="authenticate" path="/authenticate" id="6dc49e29-63a1-45b0-82ce-e3ec5a055252"><con:settings/><con:parameters/><con:method name="authenticate" id="c8fcd575-45a4-4adc-a145-b3170a1f62d8" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="FAULT"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>403</con:status><con:params/><con:element xmlns:aut="http://localhost/shanoir-ng/users/authenticate">aut:Fault</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json;charset=UTF-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:aut="http://localhost/shanoir-ng/users/authenticate">aut:Response</con:element></con:representation><con:request name="Request 1" id="ba658792-6420-46dc-95dd-7a517291e9c9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#endpoint}</con:endpoint><con:request>{
	"login": "${#Project#login}",
	"password": "${#Project#password}"
	
	}</con:request><con:originalUri>http://localhost/shanoir-ng/users/authenticate</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:testSuite id="435cb389-294b-4124-9fed-2ec60aab16e2" name="REST Shanoir-NG"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="66984b8a-40ce-4dd2-9fb6-e8739871d9a4" failOnError="true" failTestCaseOnErrors="true" keepSession="true" maxResults="0" name="TestCase 1" searchProperties="true" timeout="0" wsrmEnabled="false" wsrmVersion="1.0" wsrmAckTo="" amfAuthorisation="false" amfEndpoint="" amfLogin="" amfPassword=""><con:settings/><con:testStep type="restrequest" name="auth" id="621771c2-da00-48fd-adce-36a01b03cee0"><con:settings/><con:config service="Shanoir NG Users Microservice" resourcePath="/authenticate" methodName="authenticate" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="auth" id="ba658792-6420-46dc-95dd-7a517291e9c9" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>${#Project#endpoint}</con:endpoint><con:request>{
	"login": "${#Project#login}",
	"password": "${#Project#password}"
	
	}</con:request><con:originalUri>http://localhost/shanoir-ng/users/authenticate</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="372f8373-b7bc-43d9-80b5-2f037180866b" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:assertion type="JsonPath Existence Match" id="b74ae24c-1936-4230-adc4-41ab2884e7bc" name="JsonPath Existence Match"><con:configuration><path>$.token</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:assertion type="JsonPath Match" id="9511342d-9e84-4e23-99d0-e3e1043ae8d4" name="JsonPath Match"><con:configuration><path>$.login</path><content>${#Project#login}</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="4d557498-8a4b-4dc1-99b3-ed31467c7edd"><con:settings/><con:config><script>import groovy.json.JsonSlurper
responseContent = testRunner.testCase.getTestStepByName("auth").getPropertyValue("response")
token_auth = new JsonSlurper().parseText(responseContent).token
testRunner.testCase.setPropertyValue( 'token_auth', token_auth );
log.info( token_auth );

token_xsrf = testRunner.testCase.getTestStepByName('auth').httpRequest.response.responseHeaders['Set-Cookie'];
token_xsrf = token_xsrf[0].replace('XSRF-TOKEN=','').replace(';path=/','');
testRunner.testCase.setPropertyValue( 'token_xsrf', token_xsrf );
log.info(token_xsrf);</script></con:config></con:testStep><con:testStep type="restrequest" name="saveNewUser" id="f9012918-1323-44e6-8291-8cc822987a12"><con:settings/><con:config service="Shanoir NG Users Microservice" resourcePath="/user" methodName="saveNewUser" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="saveNewUser" id="e900207c-3be4-4ea9-a454-1b4012a07d82" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment xmlns:con="http://eviware.com/soapui/config">
  &lt;con:entry key="x-auth-token" value="${#TestCase#token_auth}"/>
  &lt;con:entry key="x-xsrf-token" value="${#TestCase#token_xsrf}"/>
&lt;/xml-fragment></con:setting></con:settings><con:endpoint>${#Project#endpoint}</con:endpoint><con:request>{
	"username" : "test",
	"firstName" : "First name test",
	"lastName" : "Last name test",
	"email" : "testautofli@gmail.com",
	"creationDate" : "2016-11-28",
	"role" : {}
	
	
	}</con:request><con:originalUri>http://localhost/user</con:originalUri><con:assertion type="Valid HTTP Status Codes" id="46be949d-1ab6-4aee-bfcb-86f2e0104649" name="Valid HTTP Status Codes"><con:configuration><codes>200</codes></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties><con:property><con:name>token</con:name><con:value>f6a15061-efc7-4d72-ae9f-ac2de58c4fcf</con:value></con:property><con:property><con:name>token2</con:name><con:value>XSRF-TOKEN=9898f4e6-e3ff-47a0-8bc1-7dc21e84729c</con:value></con:property><con:property><con:name>token3</con:name><con:value>user:1480348228061:c1b66f9cd6eb7349f358e1659135e4ec</con:value></con:property><con:property><con:name>token4</con:name><con:value>23a65b55681e212c19191465b6af1f86</con:value></con:property><con:property><con:name>token5</con:name><con:value>10968738-d69f-40c2-87d2-878269668e48</con:value></con:property><con:property><con:name>token_auth</con:name><con:value>user:1480348327583:a7eee6e4cad65717ee2774889f436135</con:value></con:property><con:property><con:name>token_xsrf</con:name><con:value>5f27095d-3510-4a8d-856c-5bcafb935375</con:value></con:property></con:properties></con:testCase><con:properties/></con:testSuite><con:properties><con:property><con:name>endpoint</con:name><con:value>http://localhost:9900</con:value></con:property><con:property><con:name>login</con:name><con:value>user</con:value></con:property><con:property><con:name>password</con:name><con:value>password</con:value></con:property></con:properties><con:wssContainer/><con:oAuth2ProfileContainer/><con:sensitiveInformation/></con:soapui-project>